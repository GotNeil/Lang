# 日文單字練習 - 功能規格說明 (SPECIFICATION)

## 1. 總覽 (Overview)

本應用程式是一個基於 Web 的日文單字學習工具，旨在幫助使用者透過不同的練習模式來記憶日文單字、發音和用法。應用程式使用 React.js 框架開發，並將使用者的進度和設定儲存在瀏覽器的 `localStorage` 中。

---

## 2. 核心功能 (Core Features)

### 2.1 練習模式 (Practice Modes)

應用程式提供四種不同的模式，以滿足不同的學習需求：

| 模式名稱 | 圖示 | 模式說明 |
| :--- | :--- | :--- |
| **練習日文發音 (中文題目)** | 🇹🇼 | 畫面顯示中文，使用者練習說出對應的日文單字。 |
| **練習日文發音 (日文題目)** | 🇯🇵 | 畫面顯示日文漢字，使用者練習其正確的日文發音。 |
| **練習日文聽力** | 🇯🇵🎧 | 畫面不顯示文字，使用者點擊按鈕聆聽發音，並測驗自己是否知道是哪個單字。 |
| **辭典模式** | 📚 | 非測驗模式。使用者可以自由、循序地瀏覽題庫中的所有單字及其完整資訊。 |

### 2.2 題庫系統 (Category System)

- **資料來源**：所有題庫內容皆來自於 `public/data/` 目錄下的 `.json` 檔案。
- **動態載入**：應用程式啟動時會讀取 `public/data/manifest.json` 檔案，該檔案內記載了所有可用的題庫檔案名稱，並動態載入它們以供使用者選擇。
- **多重選擇**：使用者可以同時選擇一個或多個題庫來進行練習。

### 2.3 語音合成 (Speech Synthesis)

- **功能**：在答案揭曉或辭典模式中，提供「日文」和「範例」的發音按鈕。
- **技術**：使用瀏覽器內建的 Web Speech API (`window.speechSynthesis`) 來朗讀日文。
- **客製化**：使用者可以在「設定」頁面中，從目前瀏覽器/作業系統支援的語音包列表中，選擇偏好的發音語音。

---

## 3. 介面與流程 (UI and Flow)

### 3.1 主畫面 (Setup Screen)

進入應用程式後的第一個畫面，包含兩個主要區塊：

1.  **模式選擇**：以 Radio Button 的形式讓使用者選擇要進行的練習模式。
2.  **題庫選擇**：以 Checkbox 的形式列出所有可用的題庫及其單字數量，使用者可自由勾選。
3.  **開始按鈕**：選擇題庫後，點擊「開始練習」按鈕進入主畫面。

### 3.2 測驗/辭典畫面 (Quiz/Dictionary Screen)

此畫面為練習和瀏覽的主要區域，採響應式設計 (RWD)，由兩部分組成：

#### 3.2.1 主要內容區 (Main Content Area)

根據所選模式顯示不同內容：

- **測驗模式 (`中文`, `日文`, `聽力`)**:
    - **問題階段**：根據模式顯示中文、日文漢字或播放聲音的按鈕。
    - **答案階段**：點擊「查看答案」後，會顯示該單字的完整資訊，包含：
        - 日文漢字 (Kanji)
        - 平假名/片假名 (Kana)
        - 羅馬拼音 (Romaji)
        - 中文意思 (Chinese)
        - 日文例句 (Example)
        - 例句中文翻譯 (Example Chinese)
    - **熟練度**：畫面上會顯示每個單字的熟練度分數。

- **辭典模式 (`Dictionary`)**:
    - 直接顯示當前單字的完整資訊（同上）。
    - 沒有「查看答案」的步驟。

#### 3.2.2 側邊欄 (Sidebar / Tree List)

- **功能**：在畫面右側（手機版則在下方）顯示當前所選題庫的完整單字列表。
- **顯示內容**：
    - `中文` 和 `辭典` 模式下：顯示單字的**中文**。
    - `日文` 模式下：顯示單字的**日文漢字**。
    - `聽力` 模式下：顯示**題目排序** (例如: "題目 1", "題目 2")。
- **互動性**：
    - **高亮顯示**：當前正在瀏覽的單字會在列表中以高亮樣式標示。
    - **快速跳轉**：點擊列表中的任何一個單字，主內容區會立刻跳轉至該單字。
    - **自動捲動**：列表會自動捲動，以確保當前高亮的項目總是在可視範圍內。

### 3.3 測驗流程 (Quiz Flow)

1.  **出題**：系統根據所選模式出題。
2.  **揭曉答案**：使用者點擊「查看答案」。
3.  **回饋**：使用者根據自己的表現點擊「答對了！」或「答錯了」。
    - **計分**：「答對了」熟練度 +1，「答錯了」熟練度歸零。分數會即時更新並儲存於 `localStorage`。
4.  **前進**：
    - **自動前進**：若啟用，點擊回饋按鈕後會開始倒數，並自動跳轉至下一題。使用者可中途點擊「停止倒數」來暫停。
    - **手動前進**：點擊「下一題」按鈕。
5.  **回合結束**：當練習完設定的題目數量後，會顯示結束畫面，使用者可選擇「繼續練習」或「重新抽題」。

### 3.4 辭典流程 (Dictionary Flow)

1.  **載入**：題庫內容**不會**被隨機打亂，而是以原始順序呈現。
2.  **瀏覽**：使用者透過「上一筆」和「下一筆」按鈕來循序瀏覽。
3.  **循環**：瀏覽到結尾後再按「下一筆」會回到第一筆，反之亦然。

---

## 4. 設定頁面 (Settings Page)

使用者可點擊主畫面右上角的「設定」按鈕進入此頁面。所有設定在儲存後都會記錄在 `localStorage`。

- **每次考題多少題目**：設定一個練習回合的題目數量（-1 代表全部）。
- **自動轉下一題為幾秒**：設定自動前進的倒數秒數。
- **開啟答題後自動轉到下一題**：啟用或停用自動前進功能。
- **選擇語音**：下拉選單，可選擇瀏覽器/OS提供的不同語音包來作為日文發音的聲音。

---

## 5. 資料結構 (Data Structure)

題庫的 `.json` 檔案為一個陣列 (Array)，其中每個物件 (Object) 代表一個單字，結構如下：

```json
[
  {
    "kanji": "日本語",
    "kana": "にほんご",
    "romaji": "nihongo",
    "chinese": "日文",
    "example": "A: 日本語を勉強していますか？</br>B: はい、毎日勉強しています。",
    "example_chinese": "A: 你正在學日文嗎？</br>B: 是的，我每天都在學習。"
  }
]
```

---

## 6. 技術細節 (Technical Details)

- **前端框架**：React.js
- **本地儲存**：使用 `localStorage` 來儲存以下資訊：
    - `jp_scores`: 每個單字的熟練度分數。
    - `jp_settings`: 使用者的設定偏好。
- **語音功能**：使用 Web Speech API。
- **樣式**：使用標準 CSS，並透過 Media Query 實現 RWD。